version: 2

models:
  - name: fct_oura_daily
    description: |
      Daily wellness metrics combining sleep, readiness, and activity data from Oura Ring.
      One row per day with scores and derived categories.
    config:
      schema: oura
      tags: ['oura']
    columns:
      - name: day
        description: The date for these metrics
        tests:
          - unique
          - not_null
      - name: sleep_score
        description: Oura sleep score (0-100)
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100
              inclusive: true
              config:
                where: "sleep_score is not null"
      - name: readiness_score
        description: Oura readiness score (0-100)
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100
              inclusive: true
              config:
                where: "readiness_score is not null"
      - name: activity_score
        description: Oura activity score (0-100)
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100
              inclusive: true
              config:
                where: "activity_score is not null"
      - name: combined_wellness_score
        description: Average of available scores
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100
              inclusive: true
              config:
                where: "combined_wellness_score is not null"
      - name: sleep_category
        description: Sleep quality category
        tests:
          - accepted_values:
              values: ['excellent', 'good', 'fair', 'poor']
              config:
                where: "sleep_category is not null"
      - name: readiness_category
        description: Readiness category
        tests:
          - accepted_values:
              values: ['optimal', 'good', 'fair', 'poor']
              config:
                where: "readiness_category is not null"
      - name: activity_category
        description: Activity level category
        tests:
          - accepted_values:
              values: ['very_active', 'active', 'moderate', 'sedentary']
              config:
                where: "activity_category is not null"
