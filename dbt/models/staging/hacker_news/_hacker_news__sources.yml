version: 2

sources:
  - name: hacker_news
    database: "{{ env_var('GCP_PROJECT_ID') }}"
    schema: hacker_news
    tables:
      - name: raw_stories
        description: Raw Hacker News stories synced from public BigQuery dataset
        columns:
          - name: id
            description: Unique story identifier
          - name: title
            description: Story title
          - name: url
            description: Link URL (null for Ask HN, Show HN text posts)
          - name: domain
            description: Extracted domain from URL
          - name: author
            description: Username who posted
          - name: score
            description: Upvote count
          - name: descendants
            description: Comment count
          - name: posted_at
            description: When the story was posted
          - name: posted_week
            description: Week the story was posted (Monday start)

      - name: raw_comments
        description: Raw Hacker News comments with sentiment analysis via Cloudflare Workers AI
        columns:
          - name: id
            description: Unique comment identifier
          - name: parent_id
            description: Parent item ID (story for top-level comments)
          - name: story_id
            description: Root story ID that this comment belongs to
          - name: author
            description: Username who posted the comment
          - name: text
            description: Comment text (may contain HTML)
          - name: posted_at
            description: When the comment was posted
          - name: posted_month
            description: Month the comment was posted (for aggregation)
          - name: sentiment_score
            description: Sentiment score from -1 (negative) to 1 (positive), computed via Cloudflare Workers AI
          - name: sentiment_label
            description: Raw label from model (POSITIVE/NEGATIVE)
          - name: sentiment_category
            description: Categorized sentiment (positive/negative/neutral)
